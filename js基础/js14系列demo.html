<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title></title>
	<link rel="stylesheet" href="">
</head>
<body>
</body>
<script type="text/javascript">
		var len = 15;
		var aDiv = document.getElementsByTagName("div");
		Init();

		
		//生成一排块
		function Init(){
			var str ="";
			for(var i=1;i<=len;i++){
				str +="<div style='background: orange;width: 60px;height: 60px;position:absolute;top:350px;left:"+100*i+"px;'></div>";
			}
			document.body.innerHTML = str;
			//dropDiv();
			for(var j =0;j<len;j++){
				aDiv[j].index=j;
				aDiv[j].onclick = function(){
					var _this =this;
					shakeDiv(_this,"top",function(){
						shakeDiv(_this,"left");
					})
				}
			}

		}

		//让div颤抖
		function shakeDiv(obj,attr,endFn){
			var num =0;
			var timerr = null;
			var arrNum = [];//准备一个特定数组 20，-20，18，-18，16，-16，……0
			for(var i=20;i>0;i-=2){
				arrNum.push(i,-i);
			}
			arrNum.push(0);
			var pos = parseInt(getStyle(obj,attr));//有隐患  建立一个储存，可以存放变量
			clearInterval(obj.timerr);
			obj.timerr = setInterval(function(){
				obj.style[attr] = pos + arrNum[num] + "px";
				num++;
				//console.log(pos);
				if(num===arrNum.length){
					clearInterval(obj.timerr);
					endFn&&endFn();//回调函数抖完之后再做
				}
			},30)
		}

		//点击一排div掉落	
		function dropDiv(){
			var num = 0;
			var timer = null;
			document.onclick = function(){
			clearInterval(timer);
			timer = setInterval(function(){
				doMove(aDiv[num],"top",20,500);
				num++;
				if(num===len){
					clearInterval(timer);
				}
			},100);//中途缓存时间，掉第二个
			}
		}
		

		function doMove(obj,attr,step,target){
			clearInterval(obj.timer);
			obj.timer = setInterval(function(){
				var speed = parseInt(getStyle(obj,attr)) + step;
				if(speed>target){speed=target;}
				obj.style[attr]=speed+"px";
				if(speed==target){
					clearInterval(obj.timer);
				}

			},10);//下降的速度
		}

		function getStyle(obj,attr){
			return obj.currentStyle?obj.currentStyle[attr] : getComputedStyle( obj )[attr]; 
		}
	


</script>
</html>