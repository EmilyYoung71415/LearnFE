<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title></title>
	<link rel="stylesheet" href="">
</head>
<body>
	<input type="file" id="file">
</body>
<script src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="js/xlsx.core.min.js"></script>
<script >
	/*  var oE = document.getElementById("file");
	  oE.onchange = function(){
	  	console.log(1);
	  }*/

	 $('#file').change(function(e) {
            var files = e.target.files;
 
            var fileReader = new FileReader();
            fileReader.onload = function(ev) {
                try {
                    var data = ev.target.result,
                        workbook = XLSX.read(data, {
                            type: 'binary'
                        }), // 以二进制流方式读取得到整份excel表格对象
                        persons = []; // 存储获取到的数据
                } catch (e) {
                    console.log('文件类型不正确');
                    return;
                }
 
                // 遍历每张表读取
                for (var sheet in workbook.Sheets) {
                    if (workbook.Sheets.hasOwnProperty(sheet)) {
                        persons = persons.concat(XLSX.utils.get_formulae(workbook.Sheets[sheet]));
                        break; // 如果只取第一张表，就取消注释这行
                    }
                }
 			 	
 			 	var len = workbook.Strings.length;
                for(var i=0;i<len;i++){
                	console.log(persons[i].substring(4));
                }

            };

            // 以二进制方式打开文件
            fileReader.readAsBinaryString(files[0]);
        });



</script>
</html>